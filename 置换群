/**************************************************************************************************************/
所以我还是不知道置换群是啥
参考资料：
https://baike.baidu.com/item/置换群/6194655?fr=aladdin
https://blog.csdn.net/workinghardboy/article/details/79281815
/**************************************************************************************************************/
n元对称群的任意一个子群，都叫做一个n元置换群，简称置换群。
置换群是最早研究的一类群，是十分重要的群，每个有限的抽象群都与一个置换群同构，也就是说，所有的有限群都可以用它来表示。
由有限集合各元素的置换*所构成的群*。它是一种重要的有限群。
每个代数方程，都有由它的根的置换所形成的置换群存在;伽罗华*利用置换群的性质，给出了方程可用根式求解的充要条件。
由n个元素的集合中各元素的全部置换所构成的群，称为n阶对称群。讨论正n边形绕中心的对称，就得到一个对称群。
/**************************************************************************************************************/
/*
643.置换群-珠子染色 (10分) 
C时间限制：3000 毫秒 |  C内存限制：3000 Kb
题目内容：
n个珠子绕成一个环，对每个珠子染色，有3种颜色可选。环旋转或者翻转后颜色模式相同的算同一种。
计算共有多少种不同的染色模式。
输入描述
珠子数目n
输出描述
染色模式数
输入样例
4
输出样例
21
*/

#include<iostream>
#include<cmath>
using namespace std;

int gcd(int a,int b)
{
	return b==0?a:gcd(b,a%b);
 } 

int main()
{
	int n;
	cin>>n;
	int sum=0;
	for(int i=1;i<=n;i++)
	{
		sum+=(int)pow(3,gcd(n,i));//n个置换 
	}
	if(n%2==0)
	{
			sum+=(n/2)*pow(3,(n/2));//两条边的情况，有n种 
			sum+=(n/2)*pow(3,(n/2)+1);//两个点的情况，有n/2种 
	 } 
	 else
	 {
	 	sum+=n*pow(3,(n-1)/2+1);
	  } 
	  sum=sum/(2*n);
	cout<<sum<<endl;
	return 0;
	
}
/**************************************************************************************************************/
/**************************************************************************************************************/
